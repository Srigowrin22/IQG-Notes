//package training.iqgateway.controller;
//
//import java.util.List;
//
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.http.HttpStatus;
//import org.springframework.http.ResponseEntity;
//import org.springframework.web.bind.annotation.CrossOrigin;
//import org.springframework.web.bind.annotation.DeleteMapping;
//import org.springframework.web.bind.annotation.GetMapping;
//import org.springframework.web.bind.annotation.PathVariable;
//import org.springframework.web.bind.annotation.PostMapping;
//import org.springframework.web.bind.annotation.PutMapping;
//import org.springframework.web.bind.annotation.RequestBody;
//import org.springframework.web.bind.annotation.RequestMapping;
//import org.springframework.web.bind.annotation.RestController;
//
//import training.iqgateway.dto.AdminDTO;
//import training.iqgateway.dto.RolesDTO;
//import training.iqgateway.entities.AdminEO;
//import training.iqgateway.entities.RoleEO;
//import training.iqgateway.service.AdminService;
//
//@RestController
////@RequestMapping("/api/admin")
////@CrossOrigin(origins = "url")
//public class AdminController {
//
//	@Autowired
//	private AdminService adminServiceRef;
//
//	@GetMapping("/showAdmins")
//	public List<AdminDTO> fetchAllAdmin() {
//		return adminServiceRef.getAdminEOFindAll();
//	}
//	
//	@PostMapping("/addAdmin")
//	public ResponseEntity<AdminEO> addAdmin(@RequestBody AdminEO adminEO) {
//	    try {
//	        AdminEO savedAdmin = adminServiceRef.persistAdminEO(adminEO);
//	        // Return 201 Created with saved entity in body
//	        return ResponseEntity.status(HttpStatus.CREATED).body(savedAdmin);
//	    } catch (Exception e) {
//	        // Log the error if needed
//	        // Return 400 Bad Request or 500 Internal Server Error as appropriate
//	        return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();
//	    }
//	}
//
////
////	@PostMapping("/addAdmin")
////	public AdminEO addAdmin(@RequestBody AdminEO adminEO) {
////		return adminServiceRef.persistAdminEO(adminEO);
////	}
//
//	@PutMapping("/updateAdmin")
//	public String updateRole(@RequestBody AdminEO adminEO) {
//		return adminServiceRef.mergeAdminEO(adminEO);
//	}
//
//	// TODO
//
//	@GetMapping("/findByAdminByRoleID/{roleId}")
//	public List<AdminEO> findAdminByRoleID(@PathVariable Long roleId) {
//		return adminServiceRef.findAdminByRoleID(roleId);
//	}
//
//	@GetMapping("/showRoles")
//	public List<RolesDTO> fetchAllRoles() {
//		return adminServiceRef.getRoleEOFindAll();
//	}
//
//	@PostMapping("/addRole")
//	public String addRole(@RequestBody RoleEO roleEO) {
//		String res = adminServiceRef.persistRoleEO(roleEO);
//		return res;
//	}
//
//	@PutMapping("/updateRole")
//	public String updateRole(@RequestBody RoleEO roleEO) {
//		return adminServiceRef.mergeRoleEO(roleEO);
//	}
//
//	@DeleteMapping("/deleteRole")
//	public Boolean deleteRole(@RequestBody RoleEO roleEO) {
//		return adminServiceRef.removeRoleEO(roleEO);
//	}
//
//	@GetMapping("/findByRoleID/{roleId}")
//	public RoleEO findByRoleID(@PathVariable Long roleId) {
//		return adminServiceRef.findRoleByRoleID(roleId);
//	}
//
//	@GetMapping("/findByRoleName/{roleName}")
//	public RoleEO findByRoleName(@PathVariable String roleName) {
//		return adminServiceRef.findRoleByRoleName(roleName);
//	}
//
//}

package training.iqgateway.controller;

import java.util.List;

import javax.validation.Valid;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import training.iqgateway.dto.AdminDTO;
import training.iqgateway.dto.RolesDTO;
import training.iqgateway.entities.AdminEO;
import training.iqgateway.entities.RoleEO;
import training.iqgateway.service.AdminService;

@RestController
@RequestMapping("/api/admin")
@CrossOrigin(origins = "*")  // Adjust origins as needed
public class AdminController {

    @Autowired
    private AdminService adminServiceRef;

    @GetMapping("/showAdmins")
    public ResponseEntity<List<AdminDTO>> fetchAllAdmin() {
        List<AdminDTO> admins = adminServiceRef.getAdminEOFindAll();
        return ResponseEntity.ok(admins);
    }

    @PostMapping("/addAdmin")
    public ResponseEntity<?> addAdmin(@Valid @RequestBody AdminEO adminEO) {
        try {
            AdminEO savedAdmin = adminServiceRef.persistAdminEO(adminEO);
            return ResponseEntity.status(HttpStatus.CREATED).body(savedAdmin);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body("Error adding admin: " + e.getMessage());
        }
    }

    @PutMapping("/updateAdmin")
    public ResponseEntity<?> updateAdmin(@Valid @RequestBody AdminEO adminEO) {
        try {
            String msg = adminServiceRef.mergeAdminEO(adminEO);
            return ResponseEntity.ok(msg);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.NOT_FOUND).body("Error updating admin: " + e.getMessage());
        }
    }

    @DeleteMapping("/deleteAdmin")
    public ResponseEntity<?> deleteAdmin(@Valid @RequestBody AdminEO adminEO) {
        try {
            Boolean deleted = adminServiceRef.removeAdminEO(adminEO);
            if (deleted) {
                return ResponseEntity.ok("Admin deleted successfully");
            } else {
                return ResponseEntity.status(HttpStatus.NOT_FOUND).body("Admin not found");
            }
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body("Error deleting admin: " + e.getMessage());
        }
    }

    @GetMapping("/findByAdminByRoleID/{roleId}")
    public ResponseEntity<List<AdminEO>> findAdminByRoleID(@PathVariable Long roleId) {
        List<AdminEO> admins = adminServiceRef.findAdminByRoleID(roleId);
        return ResponseEntity.ok(admins);
    }

    @GetMapping("/showRoles")
    public ResponseEntity<List<RolesDTO>> fetchAllRoles() {
        List<RolesDTO> roles = adminServiceRef.getRoleEOFindAll();
        return ResponseEntity.ok(roles);
    }

    @PostMapping("/addRole")
    public ResponseEntity<String> addRole(@Valid @RequestBody RoleEO roleEO) {
        try {
            String res = adminServiceRef.persistRoleEO(roleEO);
            return ResponseEntity.status(HttpStatus.CREATED).body(res);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body("Error adding role: " + e.getMessage());
        }
    }

    @PutMapping("/updateRole")
    public ResponseEntity<String> updateRole(@Valid @RequestBody RoleEO roleEO) {
        try {
            String res = adminServiceRef.mergeRoleEO(roleEO);
            return ResponseEntity.ok(res);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body("Error updating role: " + e.getMessage());
        }
    }

    @DeleteMapping("/deleteRole")
    public ResponseEntity<?> deleteRole(@Valid @RequestBody RoleEO roleEO) {
        try {
            Boolean deleted = adminServiceRef.removeRoleEO(roleEO);
            if (deleted) {
                return ResponseEntity.ok("Role deleted successfully");
            } else {
                return ResponseEntity.status(HttpStatus.NOT_FOUND).body("Role not found");
            }
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.BAD_REQUEST).body("Error deleting role: " + e.getMessage());
        }
    }

    @GetMapping("/findByRoleID/{roleId}")
    public ResponseEntity<RoleEO> findByRoleID(@PathVariable Long roleId) {
        RoleEO role = adminServiceRef.findRoleByRoleID(roleId);
        if (role != null) {
            return ResponseEntity.ok(role);
        }
        return ResponseEntity.status(HttpStatus.NOT_FOUND).build();
    }

    @GetMapping("/findByRoleName/{roleName}")
    public ResponseEntity<RoleEO> findByRoleName(@PathVariable String roleName) {
        RoleEO role = adminServiceRef.findRoleByRoleName(roleName);
        if (role != null) {
            return ResponseEntity.ok(role);
        }
        return ResponseEntity.status(HttpStatus.NOT_FOUND).build();
    }
}
