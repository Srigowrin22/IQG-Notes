package training.iqgateway.dao.impl;

import training.iqgateway.dao.DepartmentDAO;

public class DepartmentDAOImpl implements DepartmentDAO{
	
	package training.iqgateway.dao.impl;
	 
	import java.util.List;
	 
	import javax.sql.DataSource;
	 
	import org.springframework.jdbc.core.BeanPropertyRowMapper;

	import org.springframework.jdbc.core.JdbcTemplate;
	 
	import training.iqgateway.dao.DepartmentDAO;

	import training.iqgateway.entities.DepartmentEO;

	import training.iqgateway.rowmappers.DepartmentRowMapper;
	 
	public class DepartmentDAOImpl implements DepartmentDAO {
	 
		private DataSource datasourceRef;

		private JdbcTemplate jdbcTemplateRef;

		public DepartmentDAOImpl() {

			// TODO Auto-generated constructor stub

		}

		public DepartmentDAOImpl(DataSource datasourceRef) {

			super();

			this.datasourceRef = datasourceRef;

			this.jdbcTemplateRef = new JdbcTemplate(this.datasourceRef);

		}
	 
		public DataSource getDatasourceRef() {

			return datasourceRef;

		}
	 
		public void setDatasourceRef(DataSource datasourceRef) {

			this.datasourceRef = datasourceRef;

			this.jdbcTemplateRef = new JdbcTemplate(this.datasourceRef);

		}
	 
		@Override

		public int insertDepartment(DepartmentEO departmentEORef) {

			// TODO Auto-generated method stub

			String SQLStatement = 

			"INSERT INTO DEPARTMENTS VALUES ( " + departmentEORef.getDepartmentId() 

					+ "," +"'"+ departmentEORef.getDepartmentName() + "'"

					+ "," + departmentEORef.getManagerId()

					+ "," + departmentEORef.getLocationId()

							  + ")";

			this.jdbcTemplateRef.execute(SQLStatement);

			return 0;

		}
	 
		@Override

		public int updateDepartment(DepartmentEO departmentEORef) {

			// TODO Auto-generated method stub

			return 0;

		}
	 
		@Override

		public int deleteDepartment(Integer departmentId) {

			// TODO Auto-generated method stub

			return 0;

		}
	 
		@Override

		public DepartmentEO findDepartmentById(Integer departmentId) {

			// TODO Auto-generated method stub

			String SQLStatement = 

					"SELECT * FROM DEPARTMENTS WHERE DEPARTMENT_ID = ?";

//			DepartmentEO returnedDepartmentEORef = 

//					this.jdbcTemplateRef.queryForObject(SQLStatement, 

//							new Object[]{ departmentId }, new DepartmentRowMapper());
	 
			DepartmentEO returnedDepartmentEORef = 

			(DepartmentEO)this.jdbcTemplateRef.queryForObject(SQLStatement, 

					new Object[]{ departmentId }, new BeanPropertyRowMapper(DepartmentEO.class));
	 
			

			return returnedDepartmentEORef;

		}
	 
		@Override

		public List<DepartmentEO> findAll() {

			// TODO Auto-generated method stub

			String SQLStatement = "SELECT * FROM DEPARTMENTS";

			List<DepartmentEO> returnedDeptList = 

					this.jdbcTemplateRef.query(SQLStatement, new DepartmentRowMapper());

			return returnedDeptList;

		}
	 
	}

	 
	package training.iqgateway.rowmappers;
	 
	import java.sql.ResultSet;

	import java.sql.SQLException;
	 
	import org.springframework.jdbc.core.RowMapper;
	 
	import training.iqgateway.entities.DepartmentEO;
	 
	public class DepartmentRowMapper implements RowMapper<DepartmentEO> {
	 
		@Override

		public DepartmentEO mapRow(ResultSet rs, int rowNum) throws SQLException {

			// TODO Auto-generated method stub

			DepartmentEO departmentEORef = new DepartmentEO();

			departmentEORef.setDepartmentId(rs.getInt("DEPARTMENT_ID"));

			departmentEORef.setDepartmentName(rs.getString("DEPARTMENT_NAME"));

			departmentEORef.setManagerId(rs.getInt("MANAGER_ID"));

			departmentEORef.setLocationId(rs.getInt("LOCATION_ID"));

			return departmentEORef;

		}
	 
	}

	 
}
